<?php
if (session_status() === PHP_SESSION_NONE) {
    session_start();
}
require_once __DIR__ . '/db.php';
function getCurrentLanguage() {
    if (isset($_GET['lang']) && in_array($_GET['lang'], ['ru', 'en'])) {
        $lang = $_GET['lang'];
        setLanguage($lang);
        return $lang;
    }
    if (function_exists('isLoggedIn') && isLoggedIn()) {
        $user = getCurrentUser();
        if ($user && isset($user['language']) && !empty($user['language'])) {
            return $user['language'];
        }
    }
    if (isset($_SESSION['language'])) {
        return $_SESSION['language'];
    }
    return 'ru';
}
function setLanguage($lang) {
    $_SESSION['language'] = $lang;
    if (function_exists('isLoggedIn') && isLoggedIn()) {
        $user = getCurrentUser();
        if ($user && isset($user['id'])) {
            try {
                $pdo = getDB()->getConnection();
                $stmt = $pdo->prepare("UPDATE users SET language = ? WHERE id = ?");
                $stmt->execute([$lang, $user['id']]);
            } catch (Exception $e) {
                error_log("Error updating user language: " . $e->getMessage());
            }
        }
    }
}
$translations = [
    'ru' => [
        'site_name' => 'QuestGuideRF',
        'home' => 'Ð“Ð»Ð°Ð²Ð½Ð°Ñ',
        'routes' => 'Ð­ÐºÑÐºÑƒÑ€ÑÐ¸Ð¸',
        'photos' => 'Ð¤Ð¾Ñ‚Ð¾',
        'payments' => 'ÐŸÐ¾ÐºÑƒÐ¿ÐºÐ¸',
        'bank' => 'Ð‘Ð°Ð½Ðº',
        'achievements' => 'Ð”Ð¾ÑÑ‚Ð¸Ð¶ÐµÐ½Ð¸Ñ',
        'reviews' => 'ÐžÑ‚Ð·Ñ‹Ð²Ñ‹',
        'certificates' => 'Ð¡ÐµÑ€Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ñ‹',
        'no_certificates' => 'Ð£ Ð²Ð°Ñ Ð¿Ð¾ÐºÐ° Ð½ÐµÑ‚ ÑÐµÑ€Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ð¾Ð²',
        'complete_quest_for_certificate' => 'Ð—Ð°Ð²ÐµÑ€ÑˆÐ¸Ñ‚Ðµ ÐºÐ²ÐµÑÑ‚, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ ÑÐµÑ€Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚',
        'view_routes' => 'ÐŸÐ¾ÑÐ¼Ð¾Ñ‚Ñ€ÐµÑ‚ÑŒ Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚Ñ‹',
        'create_certificates_for_completed' => 'Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ ÑÐµÑ€Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ñ‹ Ð´Ð»Ñ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð½Ñ‹Ñ… ÐºÐ²ÐµÑÑ‚Ð¾Ð²',
        'create_certificate' => 'Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ ÑÐµÑ€Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚',
        'creating' => 'Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ',
        'created' => 'Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¾',
        'download_album' => 'Ð¡ÐºÐ°Ñ‡Ð°Ñ‚ÑŒ Ð°Ð»ÑŒÐ±Ð¾Ð¼',
        'download_certificate' => 'Ð¡ÐºÐ°Ñ‡Ð°Ñ‚ÑŒ ÑÐµÑ€Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚',
        'settings' => 'ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸',
        'about' => 'Ðž Ð½Ð°Ñ',
        'contact' => 'ÐšÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ñ‹',
        'login' => 'Ð’Ð¾Ð¹Ñ‚Ð¸',
        'logout' => 'Ð’Ñ‹Ð¹Ñ‚Ð¸',
        'admin_panel' => 'ÐÐ´Ð¼Ð¸Ð½-Ð¿Ð°Ð½ÐµÐ»ÑŒ',
        'select_city' => 'Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð³Ð¾Ñ€Ð¾Ð´',
        'select_route' => 'Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚',
        'price' => 'Ð¦ÐµÐ½Ð°',
        'duration' => 'Ð”Ð»Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ',
        'difficulty' => 'Ð¡Ð»Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ',
        'start_quest' => 'ÐÐ°Ñ‡Ð°Ñ‚ÑŒ ÐºÐ²ÐµÑÑ‚',
        'view_details' => 'ÐŸÐ¾Ð´Ñ€Ð¾Ð±Ð½ÐµÐµ',
        'no_routes' => 'ÐœÐ°Ñ€ÑˆÑ€ÑƒÑ‚Ñ‹ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ñ‹',
        'write_review' => 'ÐÐ°Ð¿Ð¸ÑÐ°Ñ‚ÑŒ Ð¾Ñ‚Ð·Ñ‹Ð²',
        'rating' => 'Ð ÐµÐ¹Ñ‚Ð¸Ð½Ð³',
        'your_rating' => 'Ð’Ð°ÑˆÐ° Ð¾Ñ†ÐµÐ½ÐºÐ°',
        'your_review' => 'Ð’Ð°Ñˆ Ð¾Ñ‚Ð·Ñ‹Ð²',
        'submit' => 'ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ',
        'cancel' => 'ÐžÑ‚Ð¼ÐµÐ½Ð°',
        'points' => 'Ð¢Ð¾Ñ‡ÐµÐº',
        'time' => 'Ð’Ñ€ÐµÐ¼Ñ',
        'distance' => 'Ð Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ðµ',
        'free' => 'Ð‘ÐµÑÐ¿Ð»Ð°Ñ‚Ð½Ð¾',
        'paid' => 'ÐŸÐ»Ð°Ñ‚Ð½Ð¾',
        'completed' => 'Ð—Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¾',
        'in_progress' => 'Ð’ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐµ',
        'not_started' => 'ÐÐµ Ð½Ð°Ñ‡Ð°Ñ‚Ð¾',
        'my_stats' => 'ÐœÐ¾Ñ ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°',
        'total_routes' => 'Ð’ÑÐµÐ³Ð¾ Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚Ð¾Ð²',
        'completed_routes' => 'Ð—Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¾ Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚Ð¾Ð²',
        'total_points' => 'Ð’ÑÐµÐ³Ð¾ Ñ‚Ð¾Ñ‡ÐµÐº',
        'completed_points' => 'ÐŸÑ€Ð¾Ð¹Ð´ÐµÐ½Ð¾ Ñ‚Ð¾Ñ‡ÐµÐº',
        'total_time' => 'ÐžÐ±Ñ‰ÐµÐµ Ð²Ñ€ÐµÐ¼Ñ',
        'total_distance' => 'ÐžÐ±Ñ‰ÐµÐµ Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ðµ',
        'no_data' => 'ÐÐµÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ…',
        'settings_title' => 'ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸',
        'settings_subtitle' => 'Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚Ð¾Ð¼ Ð¸ Ð¿Ñ€ÐµÐ´Ð¿Ð¾Ñ‡Ñ‚ÐµÐ½Ð¸ÑÐ¼Ð¸',
        'profile' => 'ÐŸÑ€Ð¾Ñ„Ð¸Ð»ÑŒ',
        'change_avatar' => 'Ð˜Ð·Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ',
        'avatar_upload_hint' => 'Ð”Ð°Ð½Ð½Ñ‹Ðµ ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð¸Ñ€ÑƒÑŽÑ‚ÑÑ Ñ Ð²Ð°ÑˆÐ¸Ð¼ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»ÐµÐ¼ Telegram Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸. Ð’Ñ‹ Ð¼Ð¾Ð¶ÐµÑ‚Ðµ Ð·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ ÑÐ¾Ð±ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ð¹ Ð°Ð²Ð°Ñ‚Ð°Ñ€ (Ð¼Ð°ÐºÑ. 5 ÐœÐ‘).',
        'appearance' => 'Ð’Ð½ÐµÑˆÐ½Ð¸Ð¹ Ð²Ð¸Ð´',
        'theme' => 'Ð¢ÐµÐ¼Ð° Ð¾Ñ„Ð¾Ñ€Ð¼Ð»ÐµÐ½Ð¸Ñ',
        'theme_description' => 'Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ ÑÐ²ÐµÑ‚Ð»ÑƒÑŽ Ð¸Ð»Ð¸ Ñ‚Ñ‘Ð¼Ð½ÑƒÑŽ Ñ‚ÐµÐ¼Ñƒ',
        'theme_light' => 'Ð¡Ð²ÐµÑ‚Ð»Ð°Ñ',
        'theme_dark' => 'Ð¢Ñ‘Ð¼Ð½Ð°Ñ',
        'theme_auto' => 'ÐÐ²Ñ‚Ð¾',
        'language_setting' => 'Ð¯Ð·Ñ‹Ðº Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹ÑÐ°',
        'language_description' => 'Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ ÑÐ·Ñ‹Ðº Ð´Ð»Ñ Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹ÑÐ° ÑÐ°Ð¹Ñ‚Ð° Ð¸ Ð±Ð¾Ñ‚Ð°',
        'language_russian' => 'Ð ÑƒÑÑÐºÐ¸Ð¹',
        'language_english' => 'English',
        'statistics' => 'Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°',
        'registration_date' => 'Ð”Ð°Ñ‚Ð° Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸:',
        'last_login' => 'ÐŸÐ¾ÑÐ»ÐµÐ´Ð½Ð¸Ð¹ Ð²Ñ…Ð¾Ð´:',
        'telegram_bot' => 'Telegram Ð±Ð¾Ñ‚',
        'telegram_bot_description' => 'Ð’Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²ÑƒÐ¹Ñ‚Ðµ Ñ Ð±Ð¾Ñ‚Ð¾Ð¼ Ð´Ð»Ñ Ð¿Ñ€Ð¾Ñ…Ð¾Ð¶Ð´ÐµÐ½Ð¸Ñ ÐºÐ²ÐµÑÑ‚Ð¾Ð² Ð¸ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð´Ð¾ÑÑ‚Ð¸Ð¶ÐµÐ½Ð¸Ð¹.',
        'open_bot' => 'ÐžÑ‚ÐºÑ€Ñ‹Ñ‚ÑŒ Ð±Ð¾Ñ‚Ð°',
        'logout' => 'Ð’Ñ‹Ñ…Ð¾Ð´ Ð¸Ð· Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚Ð°',
        'logout_description' => 'Ð’Ñ‹ Ð±ÑƒÐ´ÐµÑ‚Ðµ Ð¿ÐµÑ€ÐµÐ½Ð°Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ñ‹ Ð½Ð° ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñƒ Ð²Ñ…Ð¾Ð´Ð°.',
        'logout_button' => 'Ð’Ñ‹Ð¹Ñ‚Ð¸',
        'uploading' => 'Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ°...',
        'avatar_updated' => 'ÐÐ²Ð°Ñ‚Ð°Ñ€ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð¾Ð±Ð½Ð¾Ð²Ð»Ñ‘Ð½!',
        'upload_error' => 'ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸',
        'file_too_large' => 'Ð Ð°Ð·Ð¼ÐµÑ€ Ñ„Ð°Ð¹Ð»Ð° Ð½Ðµ Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð¿Ñ€ÐµÐ²Ñ‹ÑˆÐ°Ñ‚ÑŒ 5 ÐœÐ‘',
        'invalid_file_type' => 'Ð Ð°Ð·Ñ€ÐµÑˆÐµÐ½Ñ‹ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ: JPG, PNG, GIF, WEBP',
        'hello' => 'ÐŸÑ€Ð¸Ð²ÐµÑ‚',
        'level' => 'Ð£Ñ€Ð¾Ð²ÐµÐ½ÑŒ',
        'routes_completed' => 'ÐŸÑ€Ð¾Ð¹Ð´ÐµÐ½Ð¾ Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚Ð¾Ð²',
        'points_completed' => 'ÐŸÑ€Ð¾Ð¹Ð´ÐµÐ½Ð¾ Ñ‚Ð¾Ñ‡ÐµÐº',
        'time_in_quests' => 'Ð’Ñ€ÐµÐ¼Ñ Ð² ÐºÐ²ÐµÑÑ‚Ð°Ñ…',
        'achievements' => 'Ð”Ð¾ÑÑ‚Ð¸Ð¶ÐµÐ½Ð¸Ð¹',
        'active_quests' => 'ÐÐºÑ‚Ð¸Ð²Ð½Ñ‹Ðµ ÐºÐ²ÐµÑÑ‚Ñ‹',
        'all_routes' => 'Ð’ÑÐµ Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚Ñ‹',
        'completed_progress' => 'ÐŸÑ€Ð¾Ð¹Ð´ÐµÐ½Ð¾',
        'continue_in_bot' => 'ÐŸÑ€Ð¾Ð´Ð¾Ð»Ð¶Ð¸Ñ‚ÑŒ Ð² Ð±Ð¾Ñ‚Ðµ',
        'quick_actions' => 'Ð‘Ñ‹ÑÑ‚Ñ€Ñ‹Ðµ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ',
        'my_routes' => 'ÐœÐ¾Ð¸ ÑÐºÑÐºÑƒÑ€ÑÐ¸Ð¸',
        'photos' => 'Ð¤Ð¾Ñ‚Ð¾Ð³Ñ€Ð°Ñ„Ð¸Ð¸',
        'purchases' => 'ÐŸÐ¾ÐºÑƒÐ¿ÐºÐ¸',
        'open_bot' => 'ÐžÑ‚ÐºÑ€Ñ‹Ñ‚ÑŒ Ð±Ð¾Ñ‚Ð°',
        'reviews_title' => 'ÐžÑ‚Ð·Ñ‹Ð²Ñ‹',
        'reviews_subtitle' => 'Ð§Ñ‚Ð¾ Ð³Ð¾Ð²Ð¾Ñ€ÑÑ‚ Ð½Ð°ÑˆÐ¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ð¸ Ð¾ ÐºÐ²ÐµÑÑ‚Ð°Ñ…',
        'total_reviews' => 'Ð’ÑÐµÐ³Ð¾ Ð¾Ñ‚Ð·Ñ‹Ð²Ð¾Ð²',
        'routes_with_reviews' => 'ÐœÐ°Ñ€ÑˆÑ€ÑƒÑ‚Ð¾Ð² Ñ Ð¾Ñ‚Ð·Ñ‹Ð²Ð°Ð¼Ð¸',
        'route_filter' => 'ÐœÐ°Ñ€ÑˆÑ€ÑƒÑ‚',
        'all_routes_filter' => 'Ð’ÑÐµ Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚Ñ‹',
        'rating_filter' => 'Ð ÐµÐ¹Ñ‚Ð¸Ð½Ð³',
        'any_rating' => 'Ð›ÑŽÐ±Ð¾Ð¹',
        'search' => 'ÐÐ°Ð¹Ñ‚Ð¸',
        'reset' => 'Ð¡Ð±Ñ€Ð¾ÑÐ¸Ñ‚ÑŒ',
        'no_reviews' => 'ÐŸÐ¾ÐºÐ° Ð½ÐµÑ‚ Ð¾Ñ‚Ð·Ñ‹Ð²Ð¾Ð²',
        'recent_achievements' => 'ÐŸÐ¾ÑÐ»ÐµÐ´Ð½Ð¸Ðµ Ð´Ð¾ÑÑ‚Ð¸Ð¶ÐµÐ½Ð¸Ñ',
        'all_achievements' => 'Ð’ÑÐµ Ð´Ð¾ÑÑ‚Ð¸Ð¶ÐµÐ½Ð¸Ñ',
        'my_routes_title' => 'ÐœÐ¾Ð¸ ÑÐºÑÐºÑƒÑ€ÑÐ¸Ð¸',
        'my_routes_subtitle' => 'Ð’ÑÐµ Ð²Ð°ÑˆÐ¸ Ð¿Ñ€Ð¾Ð¹Ð´ÐµÐ½Ð½Ñ‹Ðµ Ð¸ Ñ‚ÐµÐºÑƒÑ‰Ð¸Ðµ Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚Ñ‹',
        'no_routes_yet' => 'Ð£ Ð²Ð°Ñ Ð¿Ð¾ÐºÐ° Ð½ÐµÑ‚ ÑÐºÑÐºÑƒÑ€ÑÐ¸Ð¹',
        'start_first_adventure' => 'ÐÐ°Ñ‡Ð½Ð¸Ñ‚Ðµ ÑÐ²Ð¾Ðµ Ð¿ÐµÑ€Ð²Ð¾Ðµ Ð¿Ñ€Ð¸ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ð² Ð±Ð¾Ñ‚Ðµ!',
        'in_progress' => 'Ð’ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐµ',
        'completed' => 'Ð—Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¾',
        'abandoned' => 'ÐŸÑ€ÐµÑ€Ð²Ð°Ð½Ð¾',
        'continue_quest' => 'ÐŸÑ€Ð¾Ð´Ð¾Ð»Ð¶Ð¸Ñ‚ÑŒ ÐºÐ²ÐµÑÑ‚',
        'view_details' => 'ÐŸÐ¾Ð´Ñ€Ð¾Ð±Ð½ÐµÐµ',
        'photos_title' => 'Ð¤Ð¾Ñ‚Ð¾Ð³Ñ€Ð°Ñ„Ð¸Ð¸',
        'photos_subtitle' => 'Ð’Ð°ÑˆÐ¸ ÑÐ½Ð¸Ð¼ÐºÐ¸ Ð¸Ð· ÐºÐ²ÐµÑÑ‚Ð¾Ð²',
        'filter_by_route' => 'Ð¤Ð¸Ð»ÑŒÑ‚Ñ€ Ð¿Ð¾ Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚Ñƒ:',
        'all_routes_filter' => 'Ð’ÑÐµ Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚Ñ‹',
        'no_photos_yet' => 'ÐŸÐ¾ÐºÐ° Ð½ÐµÑ‚ Ñ„Ð¾Ñ‚Ð¾Ð³Ñ€Ð°Ñ„Ð¸Ð¹',
        'start_quest_and_photo' => 'ÐÐ°Ñ‡Ð½Ð¸Ñ‚Ðµ ÐºÐ²ÐµÑÑ‚ Ð¸ Ð´ÐµÐ»Ð°Ð¹Ñ‚Ðµ ÑÐ½Ð¸Ð¼ÐºÐ¸!',
        'file_not_found' => 'Ð¤Ð°Ð¹Ð» Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½',
        'payments_title' => 'Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð¿Ð¾ÐºÑƒÐ¿Ð¾Ðº',
        'payments_subtitle' => 'Ð’ÑÐµ Ð²Ð°ÑˆÐ¸ Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð¸ Ð¸ Ð¿Ð¾ÐºÑƒÐ¿ÐºÐ¸',
        'total_spent' => 'Ð’ÑÐµÐ³Ð¾ Ð¿Ð¾Ñ‚Ñ€Ð°Ñ‡ÐµÐ½Ð¾',
        'total_purchases' => 'Ð’ÑÐµÐ³Ð¾ Ð¿Ð¾ÐºÑƒÐ¿Ð¾Ðº',
        'no_purchases_yet' => 'ÐŸÐ¾ÐºÐ° Ð½ÐµÑ‚ Ð¿Ð¾ÐºÑƒÐ¿Ð¾Ðº',
        'buy_first_route' => 'ÐŸÑ€Ð¸Ð¾Ð±Ñ€ÐµÑ‚Ð¸Ñ‚Ðµ Ð¿ÐµÑ€Ð²Ñ‹Ð¹ Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚ Ð² Ð±Ð¾Ñ‚Ðµ!',
        'payment_id' => 'ID',
        'achievements_title' => 'Ð”Ð¾ÑÑ‚Ð¸Ð¶ÐµÐ½Ð¸Ñ',
        'achievements_subtitle' => 'Ð¡Ð¾Ð±Ð¸Ñ€Ð°Ð¹Ñ‚Ðµ Ð´Ð¾ÑÑ‚Ð¸Ð¶ÐµÐ½Ð¸Ñ, Ð¿Ñ€Ð¾Ñ…Ð¾Ð´Ñ ÐºÐ²ÐµÑÑ‚Ñ‹',
        'progress' => 'ÐŸÑ€Ð¾Ð³Ñ€ÐµÑÑ',
        'achievements_earned' => 'Ð´Ð¾ÑÑ‚Ð¸Ð¶ÐµÐ½Ð¸Ð¹ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¾',
        'earned' => 'ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¾',
        'hidden_achievement' => 'Ð¡ÐºÑ€Ñ‹Ñ‚Ð¾Ðµ Ð´Ð¾ÑÑ‚Ð¸Ð¶ÐµÐ½Ð¸Ðµ',
        'task' => 'Ð—Ð°Ð´Ð°Ð½Ð¸Ðµ',
        'min_people' => 'ÐœÐ¸Ð½Ð¸Ð¼ÑƒÐ¼ Ð»ÑŽÐ´ÐµÐ¹',
        'started' => 'ÐÐ°Ñ‡Ð°Ñ‚Ð¾',
        'photos_button' => 'Ð¤Ð¾Ñ‚Ð¾Ð³Ñ€Ð°Ñ„Ð¸Ð¸',
        'points' => 'Ñ‚Ð¾Ñ‡ÐµÐº',
        'all_routes' => 'Ð’ÑÐµ ÑÐºÑÐºÑƒÑ€ÑÐ¸Ð¸',
        'available_routes' => 'Ð”Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ðµ ÑÐºÑÐºÑƒÑ€ÑÐ¸Ð¸',
        'view_details' => 'ÐŸÐ¾Ð´Ñ€Ð¾Ð±Ð½ÐµÐµ',
        'start_quest' => 'ÐÐ°Ñ‡Ð°Ñ‚ÑŒ ÐºÐ²ÐµÑÑ‚',
        'city' => 'Ð“Ð¾Ñ€Ð¾Ð´',
        'all_cities' => 'Ð’ÑÐµ Ð³Ð¾Ñ€Ð¾Ð´Ð°',
        'type' => 'Ð¢Ð¸Ð¿',
        'all_types' => 'Ð’ÑÐµ Ñ‚Ð¸Ð¿Ñ‹',
        'walking' => 'ÐŸÐµÑˆÐºÐ¾Ð¼',
        'cycling' => 'ÐÐ° Ð²ÐµÐ»Ð¾ÑÐ¸Ð¿ÐµÐ´Ðµ',
        'any_difficulty' => 'Ð›ÑŽÐ±Ð°Ñ',
        'easy' => 'Ð›ÐµÐ³ÐºÐ°Ñ',
        'medium' => 'Ð¡Ñ€ÐµÐ´Ð½ÑÑ',
        'hard' => 'Ð¡Ð»Ð¾Ð¶Ð½Ð°Ñ',
        'tag' => 'Ð¢ÐµÐ³',
        'all_tags' => 'Ð’ÑÐµ Ñ‚ÐµÐ³Ð¸',
        'sort_by' => 'Ð¡Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¿Ð¾',
        'sort_name' => 'ÐÐ°Ð·Ð²Ð°Ð½Ð¸ÑŽ',
        'sort_price' => 'Ð¦ÐµÐ½Ðµ',
        'sort_duration' => 'Ð”Ð»Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸',
        'sort_distance' => 'Ð Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸ÑŽ',
        'order' => 'ÐŸÐ¾Ñ€ÑÐ´Ð¾Ðº',
        'ascending' => 'ÐŸÐ¾ Ð²Ð¾Ð·Ñ€Ð°ÑÑ‚Ð°Ð½Ð¸ÑŽ',
        'descending' => 'ÐŸÐ¾ ÑƒÐ±Ñ‹Ð²Ð°Ð½Ð¸ÑŽ',
        'apply_filters' => 'ÐŸÑ€Ð¸Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ',
        'bank_title' => 'Ð‘Ð°Ð½Ðº Ð³Ñ€Ð¾ÑˆÐµÐ¹',
        'bank_subtitle' => 'Ð‘Ð°Ð»Ð°Ð½Ñ, Ð¿Ð¾Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ Ð¸ Ð¿Ð¾ÐºÑƒÐ¿ÐºÐ¸ ÑÐºÑÐºÑƒÑ€ÑÐ¸Ð¹',
        'bank_balance' => 'Ð‘Ð°Ð»Ð°Ð½Ñ',
        'bank_total_deposited' => 'Ð’ÑÐµÐ³Ð¾ Ð¿Ð¾Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¾',
        'bank_total_spent' => 'Ð’ÑÐµÐ³Ð¾ Ð¿Ð¾Ñ‚Ñ€Ð°Ñ‡ÐµÐ½Ð¾',
        'bank_total_transferred' => 'Ð’ÑÐµÐ³Ð¾ Ð¿ÐµÑ€ÐµÐ²ÐµÐ´ÐµÐ½Ð¾',
        'bank_purchases' => 'ÐŸÐ¾ÐºÑƒÐ¿ÐºÐ¸',
        'bank_bot_hint' => 'ÐŸÐ¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÑŒ Ð±Ð°Ð»Ð°Ð½Ñ, Ð¿ÐµÑ€ÐµÐ²ÐµÑÑ‚Ð¸ Ð³Ñ€Ð¾ÑˆÐ¸ Ð¸ ÐºÑƒÐ¿Ð¸Ñ‚ÑŒ ÑÐºÑÐºÑƒÑ€ÑÐ¸Ð¸ Ð¼Ð¾Ð¶Ð½Ð¾ Ð² Ð±Ð¾Ñ‚Ðµ:',
        'currency_groshi' => 'Ð³Ñ€Ð¾ÑˆÐµÐ¹',
        'duration_min' => 'Ð¼Ð¸Ð½',
        'duration_h' => 'Ñ‡',
        'welcome_guest' => 'ÐŸÑ€Ð¸Ð²ÐµÑ‚, Ð³Ð¾ÑÑ‚ÑŒ! ðŸ‘‹',
        'sign_in_to_see_stats' => 'Ð’Ð¾Ð¹Ð´Ð¸Ñ‚Ðµ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð²Ð¸Ð´ÐµÑ‚ÑŒ ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÑƒ Ð¸ Ð´Ð¾ÑÑ‚Ð¸Ð¶ÐµÐ½Ð¸Ñ.',
        'sign_in_to_see_balance' => 'Ð’Ð¾Ð¹Ð´Ð¸Ñ‚Ðµ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð²Ð¸Ð´ÐµÑ‚ÑŒ Ð±Ð°Ð»Ð°Ð½Ñ Ð¸ Ð¸ÑÑ‚Ð¾Ñ€Ð¸ÑŽ Ð¿Ð¾ÐºÑƒÐ¿Ð¾Ðº.',
    ],
    'en' => [
        'site_name' => 'QuestGuideRF',
        'home' => 'Home',
        'routes' => 'Routes',
        'photos' => 'Photos',
        'payments' => 'Purchases',
        'bank' => 'Bank',
        'achievements' => 'Achievements',
        'reviews' => 'Reviews',
        'certificates' => 'Certificates',
        'no_certificates' => 'You have no certificates yet',
        'complete_quest_for_certificate' => 'Complete a quest to get a certificate',
        'view_routes' => 'View routes',
        'create_certificates_for_completed' => 'Create certificates for completed quests',
        'create_certificate' => 'Create certificate',
        'creating' => 'Creating',
        'created' => 'Created',
        'download_album' => 'Download Album',
        'download_certificate' => 'Download certificate',
        'settings' => 'Settings',
        'about' => 'About',
        'contact' => 'Contact',
        'login' => 'Login',
        'logout' => 'Logout',
        'admin_panel' => 'Admin Panel',
        'select_city' => 'Select City',
        'select_route' => 'Select Route',
        'price' => 'Price',
        'duration' => 'Duration',
        'difficulty' => 'Difficulty',
        'start_quest' => 'Start Quest',
        'view_details' => 'View Details',
        'no_routes' => 'No routes found',
        'write_review' => 'Write Review',
        'rating' => 'Rating',
        'your_rating' => 'Your Rating',
        'your_review' => 'Your Review',
        'submit' => 'Submit',
        'cancel' => 'Cancel',
        'points' => 'Points',
        'time' => 'Time',
        'distance' => 'Distance',
        'free' => 'Free',
        'paid' => 'Paid',
        'completed' => 'Completed',
        'in_progress' => 'In Progress',
        'not_started' => 'Not Started',
        'my_stats' => 'My Stats',
        'total_routes' => 'Total Routes',
        'completed_routes' => 'Completed Routes',
        'total_points' => 'Total Points',
        'completed_points' => 'Completed Points',
        'total_time' => 'Total Time',
        'total_distance' => 'Total Distance',
        'no_data' => 'No Data',
        'settings_title' => 'Settings',
        'settings_subtitle' => 'Account and preferences management',
        'profile' => 'Profile',
        'change_avatar' => 'Change',
        'avatar_upload_hint' => 'Data is automatically synced with your Telegram profile. You can upload your own avatar (max. 5 MB).',
        'appearance' => 'Appearance',
        'theme' => 'Theme',
        'theme_description' => 'Choose light or dark theme',
        'theme_light' => 'Light',
        'theme_dark' => 'Dark',
        'theme_auto' => 'Auto',
        'language_setting' => 'Interface Language',
        'language_description' => 'Choose language for website and bot interface',
        'language_russian' => 'Russian',
        'language_english' => 'English',
        'statistics' => 'Statistics',
        'registration_date' => 'Registration Date:',
        'last_login' => 'Last Login:',
        'telegram_bot' => 'Telegram Bot',
        'telegram_bot_description' => 'Interact with the bot to complete quests and earn achievements.',
        'open_bot' => 'Open Bot',
        'logout' => 'Logout',
        'logout_description' => 'You will be redirected to the login page.',
        'logout_button' => 'Logout',
        'uploading' => 'Uploading...',
        'avatar_updated' => 'Avatar updated successfully!',
        'upload_error' => 'Upload Error',
        'file_too_large' => 'File size must not exceed 5 MB',
        'invalid_file_type' => 'Only images allowed: JPG, PNG, GIF, WEBP',
        'hello' => 'Hello',
        'level' => 'Level',
        'routes_completed' => 'Routes Completed',
        'points_completed' => 'Points Completed',
        'time_in_quests' => 'Time in Quests',
        'achievements' => 'Achievements',
        'active_quests' => 'Active Quests',
        'all_routes' => 'All Routes',
        'available_routes' => 'Available Routes',
        'completed_progress' => 'Completed',
        'continue_in_bot' => 'Continue in Bot',
        'quick_actions' => 'Quick Actions',
        'my_routes' => 'My Routes',
        'photos' => 'Photos',
        'purchases' => 'Purchases',
        'open_bot' => 'Open Bot',
        'reviews_title' => 'Reviews',
        'reviews_subtitle' => 'What our users say about quests',
        'total_reviews' => 'Total Reviews',
        'routes_with_reviews' => 'Routes with Reviews',
        'route_filter' => 'Route',
        'all_routes_filter' => 'All Routes',
        'rating_filter' => 'Rating',
        'any_rating' => 'Any',
        'search' => 'Search',
        'reset' => 'Reset',
        'no_reviews' => 'No reviews yet',
        'recent_achievements' => 'Recent Achievements',
        'all_achievements' => 'All Achievements',
        'my_routes_title' => 'My Routes',
        'my_routes_subtitle' => 'All your completed and current routes',
        'no_routes_yet' => 'You have no routes yet',
        'start_first_adventure' => 'Start your first adventure in the bot!',
        'in_progress' => 'In Progress',
        'completed' => 'Completed',
        'abandoned' => 'Abandoned',
        'continue_quest' => 'Continue Quest',
        'view_details' => 'View Details',
        'photos_title' => 'Photos',
        'photos_subtitle' => 'Your photos from quests',
        'filter_by_route' => 'Filter by Route:',
        'all_routes_filter' => 'All Routes',
        'no_photos_yet' => 'No photos yet',
        'start_quest_and_photo' => 'Start a quest and take photos!',
        'file_not_found' => 'File not found',
        'payments_title' => 'Purchase History',
        'payments_subtitle' => 'All your payments and purchases',
        'total_spent' => 'Total Spent',
        'total_purchases' => 'Total Purchases',
        'no_purchases_yet' => 'No purchases yet',
        'buy_first_route' => 'Buy your first route in the bot!',
        'payment_id' => 'ID',
        'achievements_title' => 'Achievements',
        'achievements_subtitle' => 'Collect achievements by completing quests',
        'progress' => 'Progress',
        'achievements_earned' => 'achievements earned',
        'earned' => 'Earned',
        'hidden_achievement' => 'Hidden Achievement',
        'task' => 'Task',
        'min_people' => 'Min People',
        'started' => 'Started',
        'photos_button' => 'Photos',
        'points' => 'points',
        'all_routes' => 'All Available Routes',
        'view_details' => 'View Details',
        'start_quest' => 'Start Quest',
        'city' => 'City',
        'all_cities' => 'All Cities',
        'type' => 'Type',
        'all_types' => 'All Types',
        'walking' => 'Walking',
        'cycling' => 'Cycling',
        'any_difficulty' => 'Any',
        'easy' => 'Easy',
        'medium' => 'Medium',
        'hard' => 'Hard',
        'tag' => 'Tag',
        'all_tags' => 'All Tags',
        'sort_by' => 'Sort By',
        'sort_name' => 'Name',
        'sort_price' => 'Price',
        'sort_duration' => 'Duration',
        'sort_distance' => 'Distance',
        'order' => 'Order',
        'ascending' => 'Ascending',
        'descending' => 'Descending',
        'apply_filters' => 'Apply',
        'bank_title' => 'Token Bank',
        'bank_subtitle' => 'Balance, top-ups and tour purchases',
        'bank_balance' => 'Balance',
        'bank_total_deposited' => 'Total deposited',
        'bank_total_spent' => 'Total spent',
        'bank_total_transferred' => 'Total transferred',
        'bank_purchases' => 'Purchases',
        'bank_bot_hint' => 'Top up, transfer tokens and buy tours in the Telegram bot:',
        'currency_groshi' => 'groshi',
        'duration_min' => 'min',
        'duration_h' => 'h',
        'welcome_guest' => 'Welcome, Guest! ðŸ‘‹',
        'sign_in_to_see_stats' => 'Sign in to see your statistics and achievements.',
        'sign_in_to_see_balance' => 'Sign in to view your balance and purchase history.',
    ]
];
function t($key, $lang = null) {
    global $translations;
    $lang = $lang ?? getCurrentLanguage();
    return $translations[$lang][$key] ?? $key;
}
function getLocalizedName($item, $lang = null) {
    $lang = $lang ?? getCurrentLanguage();
    if ($lang === 'en' && isset($item['name_en']) && !empty($item['name_en'])) {
        return $item['name_en'];
    }
    return $item['name'] ?? '';
}
function getLocalizedDescription($item, $lang = null) {
    $lang = $lang ?? getCurrentLanguage();
    if ($lang === 'en' && isset($item['description_en']) && !empty($item['description_en'])) {
        return $item['description_en'];
    }
    return $item['description'] ?? '';
}